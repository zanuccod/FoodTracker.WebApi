image: Visual Studio 2019

before_build:
 - nuget restore
build_script:
  - dotnet restore
  - dotnet build FoodTracker.WebApi.sln
  - dotnet test -c Release ./Services/Identity/IdentityServer.API.Test /p:CollectCoverage=true /p:CoverletOutputFormat=json /p:CoverletOutput=../../../TestResults/TestResult.json
  - dotnet test -c Release ./Services/Identity/IdentityServer.API.IntegrationTest /p:CollectCoverage=true /p:CoverletOutputFormat=opencover /p:CoverletOutput=../../../TestResults/TestResult.xml /p:MergeWith=../../../TestResults/TestResult.json
  
test:
  - /Services/Identity/IdentityServer.API.Test/bin/Release/netcoreapp3.0/IdentityServer.API.Test.dll
  - /Services/Identity/IdentityServer.API.IntegrationTest/bin/Release/netcoreapp3.0/IdentityServer.API.IntegrationTest.dll